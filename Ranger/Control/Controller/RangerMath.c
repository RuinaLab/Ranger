#include "RangerMath.h"

/* Global constants */
const float PI = 3.141592653589793;  //    = PI
const float TWO_PI = 6.283185307179586;  //    2*PI
const float SQRT_TWO = 1.414213562373095;   //   sqrt(2)
const float INV_TWO_PI = 0.159154943091895; //    = 1/(2*PI)
const float HALF_PI = 1.570796326794897;   //   = PI/2
const float DEG_TO_RAD = 0.017453292519943;    //    = PI/180


/* Performs linear interpolation to evalute y = f(x) at point x,
  given the arrays Y = f(X). If X is out of bounds, then it will.
  be coerced. It is assumed that X is monotonically increasing
  and with possibly variable spacing. */
float LinInterpVar(float x, float* X, float* Y, int nGrid) {
  float alpha; // fraction of the way through the interval
  int k0, k1;    // indicies of the bounding grid points

  // Special case - only one grid point
  if (nGrid == 1) {
    return Y[0];
  }

  x = Clamp(x, X[0], X[nGrid - 1]);  // Clamp x to be in the valid domain

  // Use dumb linear search to find the correct indicies
  for (k1 = 1; k1 < nGrid; k1 ++) {
    if (x < X[k1]) break;
  }
  k0 = k1 - 1;

  // Interpolation:
  alpha = (x - X[k0])/(X[k1] - X[k0]);
  return (1.0-alpha)*Y[k0] + alpha*Y[k1];

}


/* Perform quadratic interpolation to evalute y = f(x) at point x,
  given the arrays Y = f(X). If X is out of bounds, then it will.
  be coerced. It is assumed that X is monotonically increasing
  and uniformly spaced. The number of points in X must be odd
  and at least 3. Somewhat optimized for speed. */
float QuadInterp(float x,
                 float* X, float* Y, int nGrid,
                 float hCstScale, float hCstGrid) {

  float d0, d1, d2;  // di = x-xi
  int k0, k1, k2;    // indicies of the three grid-points

  x = Clamp(x, X[0], X[nGrid - 1]);  // Clamp x to be in the valid domain

// Figure out which grid-points to use:
  k0 = 2 * (int)((x - X[0]) * hCstGrid);
  k1 = k0 + 1;
  k2 = k0 + 2;

// Useful temp variables:
  d0 = x - X[k0];
  d1 = x - X[k1];
  d2 = x - X[k2];

// Quadratic interpolation:
  return hCstScale * ( d1 * d2 * Y[k0] - 2.0 * d0 * d2 * Y[k1] + d0 * d1 * Y[k2] );
}



/* Computes the tanh function by quadratic interpolation */
float Tanh(float x) {

  // Data for quadratic interpolation of tanh
  static float X[] = { -4.000000000000, -3.980000000000, -3.960000000000, -3.940000000000, -3.920000000000, -3.900000000000, -3.880000000000, -3.860000000000, -3.840000000000, -3.820000000000, -3.800000000000, -3.780000000000, -3.760000000000, -3.740000000000, -3.720000000000, -3.700000000000, -3.680000000000, -3.660000000000, -3.640000000000, -3.620000000000, -3.600000000000, -3.580000000000, -3.560000000000, -3.540000000000, -3.520000000000, -3.500000000000, -3.480000000000, -3.460000000000, -3.440000000000, -3.420000000000, -3.400000000000, -3.380000000000, -3.360000000000, -3.340000000000, -3.320000000000, -3.300000000000, -3.280000000000, -3.260000000000, -3.240000000000, -3.220000000000, -3.200000000000, -3.180000000000, -3.160000000000, -3.140000000000, -3.120000000000, -3.100000000000, -3.080000000000, -3.060000000000, -3.040000000000,
                       -3.020000000000, -3.000000000000, -2.980000000000, -2.960000000000, -2.940000000000, -2.920000000000, -2.900000000000, -2.880000000000, -2.860000000000, -2.840000000000, -2.820000000000, -2.800000000000, -2.780000000000, -2.760000000000, -2.740000000000, -2.720000000000, -2.700000000000, -2.680000000000, -2.660000000000, -2.640000000000, -2.620000000000, -2.600000000000, -2.580000000000, -2.560000000000, -2.540000000000, -2.520000000000, -2.500000000000, -2.480000000000, -2.460000000000, -2.440000000000, -2.420000000000, -2.400000000000, -2.380000000000, -2.360000000000, -2.340000000000, -2.320000000000, -2.300000000000, -2.280000000000, -2.260000000000, -2.240000000000, -2.220000000000, -2.200000000000, -2.180000000000, -2.160000000000, -2.140000000000, -2.120000000000, -2.100000000000, -2.080000000000, -2.060000000000, -2.040000000000,
                       -2.020000000000, -2.000000000000, -1.980000000000, -1.960000000000, -1.940000000000, -1.920000000000, -1.900000000000, -1.880000000000, -1.860000000000, -1.840000000000, -1.820000000000, -1.800000000000, -1.780000000000, -1.760000000000, -1.740000000000, -1.720000000000, -1.700000000000, -1.680000000000, -1.660000000000, -1.640000000000, -1.620000000000, -1.600000000000, -1.580000000000, -1.560000000000, -1.540000000000, -1.520000000000, -1.500000000000, -1.480000000000, -1.460000000000, -1.440000000000, -1.420000000000, -1.400000000000, -1.380000000000, -1.360000000000, -1.340000000000, -1.320000000000, -1.300000000000, -1.280000000000, -1.260000000000, -1.240000000000, -1.220000000000, -1.200000000000, -1.180000000000, -1.160000000000, -1.140000000000, -1.120000000000, -1.100000000000, -1.080000000000, -1.060000000000, -1.040000000000,
                       -1.020000000000, -1.000000000000, -0.980000000000, -0.960000000000, -0.940000000000, -0.920000000000, -0.900000000000, -0.880000000000, -0.860000000000, -0.840000000000, -0.820000000000, -0.800000000000, -0.780000000000, -0.760000000000, -0.740000000000, -0.720000000000, -0.700000000000, -0.680000000000, -0.660000000000, -0.640000000000, -0.620000000000, -0.600000000000, -0.580000000000, -0.560000000000, -0.540000000000, -0.520000000000, -0.500000000000, -0.480000000000, -0.460000000000, -0.440000000000, -0.420000000000, -0.400000000000, -0.380000000000, -0.360000000000, -0.340000000000, -0.320000000000, -0.300000000000, -0.280000000000, -0.260000000000, -0.240000000000, -0.220000000000, -0.200000000000, -0.180000000000, -0.160000000000, -0.140000000000, -0.120000000000, -0.100000000000, -0.080000000000, -0.060000000000, -0.040000000000,
                       -0.020000000000, 0.000000000000, 0.020000000000, 0.040000000000, 0.060000000000, 0.080000000000, 0.100000000000, 0.120000000000, 0.140000000000, 0.160000000000, 0.180000000000, 0.200000000000, 0.220000000000, 0.240000000000, 0.260000000000, 0.280000000000, 0.300000000000, 0.320000000000, 0.340000000000, 0.360000000000, 0.380000000000, 0.400000000000, 0.420000000000, 0.440000000000, 0.460000000000, 0.480000000000, 0.500000000000, 0.520000000000, 0.540000000000, 0.560000000000, 0.580000000000, 0.600000000000, 0.620000000000, 0.640000000000, 0.660000000000, 0.680000000000, 0.700000000000, 0.720000000000, 0.740000000000, 0.760000000000, 0.780000000000, 0.800000000000, 0.820000000000, 0.840000000000, 0.860000000000, 0.880000000000, 0.900000000000, 0.920000000000, 0.940000000000, 0.960000000000,
                       0.980000000000, 1.000000000000, 1.020000000000, 1.040000000000, 1.060000000000, 1.080000000000, 1.100000000000, 1.120000000000, 1.140000000000, 1.160000000000, 1.180000000000, 1.200000000000, 1.220000000000, 1.240000000000, 1.260000000000, 1.280000000000, 1.300000000000, 1.320000000000, 1.340000000000, 1.360000000000, 1.380000000000, 1.400000000000, 1.420000000000, 1.440000000000, 1.460000000000, 1.480000000000, 1.500000000000, 1.520000000000, 1.540000000000, 1.560000000000, 1.580000000000, 1.600000000000, 1.620000000000, 1.640000000000, 1.660000000000, 1.680000000000, 1.700000000000, 1.720000000000, 1.740000000000, 1.760000000000, 1.780000000000, 1.800000000000, 1.820000000000, 1.840000000000, 1.860000000000, 1.880000000000, 1.900000000000, 1.920000000000, 1.940000000000, 1.960000000000,
                       1.980000000000, 2.000000000000, 2.020000000000, 2.040000000000, 2.060000000000, 2.080000000000, 2.100000000000, 2.120000000000, 2.140000000000, 2.160000000000, 2.180000000000, 2.200000000000, 2.220000000000, 2.240000000000, 2.260000000000, 2.280000000000, 2.300000000000, 2.320000000000, 2.340000000000, 2.360000000000, 2.380000000000, 2.400000000000, 2.420000000000, 2.440000000000, 2.460000000000, 2.480000000000, 2.500000000000, 2.520000000000, 2.540000000000, 2.560000000000, 2.580000000000, 2.600000000000, 2.620000000000, 2.640000000000, 2.660000000000, 2.680000000000, 2.700000000000, 2.720000000000, 2.740000000000, 2.760000000000, 2.780000000000, 2.800000000000, 2.820000000000, 2.840000000000, 2.860000000000, 2.880000000000, 2.900000000000, 2.920000000000, 2.940000000000, 2.960000000000,
                       2.980000000000, 3.000000000000, 3.020000000000, 3.040000000000, 3.060000000000, 3.080000000000, 3.100000000000, 3.120000000000, 3.140000000000, 3.160000000000, 3.180000000000, 3.200000000000, 3.220000000000, 3.240000000000, 3.260000000000, 3.280000000000, 3.300000000000, 3.320000000000, 3.340000000000, 3.360000000000, 3.380000000000, 3.400000000000, 3.420000000000, 3.440000000000, 3.460000000000, 3.480000000000, 3.500000000000, 3.520000000000, 3.540000000000, 3.560000000000, 3.580000000000, 3.600000000000, 3.620000000000, 3.640000000000, 3.660000000000, 3.680000000000, 3.700000000000, 3.720000000000, 3.740000000000, 3.760000000000, 3.780000000000, 3.800000000000, 3.820000000000, 3.840000000000, 3.860000000000, 3.880000000000, 3.900000000000, 3.920000000000, 3.940000000000, 3.960000000000,
                       3.980000000000, 4.000000000000
                     };
  static float Y[] = { -0.999329299739, -0.999301937496, -0.999273459374, -0.999243819899, -0.999212971747, -0.999180865670, -0.999147450414, -0.999112672642, -0.999076476847, -0.999038805266, -0.998999597786, -0.998958791852, -0.998916322365, -0.998872121583, -0.998826119008, -0.998778241281, -0.998728412063, -0.998676551915, -0.998622578172, -0.998566404814, -0.998507942332, -0.998447097583, -0.998383773648, -0.998317869675, -0.998249280727, -0.998177897611, -0.998103606711, -0.998026289809, -0.997945823899, -0.997862080995, -0.997774927934, -0.997684226165, -0.997589831532, -0.997491594056, -0.997389357693, -0.997282960099, -0.997172232375, -0.997056998805, -0.996937076586, -0.996812275543, -0.996682397840, -0.996547237669, -0.996406580939, -0.996260204946, -0.996107878030, -0.995949359222, -0.995784397876, -0.995612733287, -0.995434094293,
                       -0.995248198867, -0.995054753687, -0.994853453692, -0.994643981628, -0.994426007562, -0.994199188396, -0.993963167351, -0.993717573430, -0.993462020877, -0.993196108594, -0.992919419558, -0.992631520201, -0.992331959777, -0.992020269702, -0.991695962873, -0.991358532960, -0.991007453678, -0.990642178027, -0.990262137512, -0.989866741333, -0.989455375546, -0.989027402201, -0.988582158446, -0.988118955603, -0.987637078217, -0.987135783066, -0.986614298151, -0.986071821644, -0.985507520808, -0.984920530883, -0.984309953939, -0.983674857694, -0.983014274297, -0.982327199079, -0.981612589265, -0.980869362656, -0.980096396266, -0.979292524938, -0.978456539910, -0.977587187356, -0.976683166890, -0.975743130031, -0.974765678641, -0.973749363326, -0.972692681805, -0.971594077255, -0.970451936613, -0.969264588869, -0.968030303316, -0.966747287784,
                       -0.965413686860, -0.964027580076, -0.962586980091, -0.961089830864, -0.959534005808, -0.957917305959, -0.956237458128, -0.954492113074, -0.952678843689, -0.950795143195, -0.948838423376, -0.946806012846, -0.944695155354, -0.942503008147, -0.940226640393, -0.937863031681, -0.935409070603, -0.932861553437, -0.930217182937, -0.927472567251, -0.924624218983, -0.921668554406, -0.918601892857, -0.915420456316, -0.912120369208, -0.908697658431, -0.905148253645, -0.901467987832, -0.897652598166, -0.893697727204, -0.889598924434, -0.885351648202, -0.880951268047, -0.876393067473, -0.871672247190, -0.866783928850, -0.861723159313, -0.856484915472, -0.851064109668, -0.845455595727, -0.839654175654, -0.833654607012, -0.827451611008, -0.821039881333, -0.814414093766, -0.807568916579, -0.800499021761, -0.793199097084, -0.785663859027, -0.777888066577,
                       -0.769866535909, -0.761594155956, -0.753065904870, -0.744276867362, -0.735222252916, -0.725897414849, -0.716297870199, -0.706419320397, -0.696257672687, -0.685809062229, -0.675069874839, -0.664036770268, -0.652706705962, -0.641076961185, -0.629145161414, -0.616909302877, -0.604367777117, -0.591519395432, -0.578363413045, -0.564899552846, -0.551128028538, -0.537049566998, -0.522665429686, -0.507977432898, -0.492987966675, -0.477700012168, -0.462117157260, -0.446243610249, -0.430084211402, -0.413644442187, -0.396930432005, -0.379948962255, -0.362707467578, -0.345214034136, -0.327477394809, -0.309506921213, -0.291312612452, -0.272905080563, -0.254295532626, -0.235495749538, -0.216518061493, -0.197375320225, -0.178080868117, -0.158648504297, -0.139092447878, -0.119427298534, -0.099667994625, -0.079829769111, -0.059928103529, -0.039978680311,
                       -0.019997333760, 0.000000000000, 0.019997333760, 0.039978680311, 0.059928103529, 0.079829769111, 0.099667994625, 0.119427298534, 0.139092447878, 0.158648504297, 0.178080868117, 0.197375320225, 0.216518061493, 0.235495749538, 0.254295532626, 0.272905080563, 0.291312612452, 0.309506921213, 0.327477394809, 0.345214034136, 0.362707467578, 0.379948962255, 0.396930432005, 0.413644442187, 0.430084211402, 0.446243610249, 0.462117157260, 0.477700012168, 0.492987966675, 0.507977432898, 0.522665429686, 0.537049566998, 0.551128028538, 0.564899552846, 0.578363413045, 0.591519395432, 0.604367777117, 0.616909302877, 0.629145161414, 0.641076961185, 0.652706705962, 0.664036770268, 0.675069874839, 0.685809062229, 0.696257672687, 0.706419320397, 0.716297870199, 0.725897414849, 0.735222252916, 0.744276867362,
                       0.753065904870, 0.761594155956, 0.769866535909, 0.777888066577, 0.785663859027, 0.793199097084, 0.800499021761, 0.807568916579, 0.814414093766, 0.821039881333, 0.827451611008, 0.833654607012, 0.839654175654, 0.845455595727, 0.851064109668, 0.856484915472, 0.861723159313, 0.866783928850, 0.871672247190, 0.876393067473, 0.880951268047, 0.885351648202, 0.889598924434, 0.893697727204, 0.897652598166, 0.901467987832, 0.905148253645, 0.908697658431, 0.912120369208, 0.915420456316, 0.918601892857, 0.921668554406, 0.924624218983, 0.927472567251, 0.930217182937, 0.932861553437, 0.935409070603, 0.937863031681, 0.940226640393, 0.942503008147, 0.944695155354, 0.946806012846, 0.948838423376, 0.950795143195, 0.952678843689, 0.954492113074, 0.956237458128, 0.957917305959, 0.959534005808, 0.961089830864,
                       0.962586980091, 0.964027580076, 0.965413686860, 0.966747287784, 0.968030303316, 0.969264588869, 0.970451936613, 0.971594077255, 0.972692681805, 0.973749363326, 0.974765678641, 0.975743130031, 0.976683166890, 0.977587187356, 0.978456539910, 0.979292524938, 0.980096396266, 0.980869362656, 0.981612589265, 0.982327199079, 0.983014274297, 0.983674857694, 0.984309953939, 0.984920530883, 0.985507520808, 0.986071821644, 0.986614298151, 0.987135783066, 0.987637078217, 0.988118955603, 0.988582158446, 0.989027402201, 0.989455375546, 0.989866741333, 0.990262137512, 0.990642178027, 0.991007453678, 0.991358532960, 0.991695962873, 0.992020269702, 0.992331959777, 0.992631520201, 0.992919419558, 0.993196108594, 0.993462020877, 0.993717573430, 0.993963167351, 0.994199188396, 0.994426007562, 0.994643981628,
                       0.994853453692, 0.995054753687, 0.995248198867, 0.995434094293, 0.995612733287, 0.995784397876, 0.995949359222, 0.996107878030, 0.996260204946, 0.996406580939, 0.996547237669, 0.996682397840, 0.996812275543, 0.996937076586, 0.997056998805, 0.997172232375, 0.997282960099, 0.997389357693, 0.997491594056, 0.997589831532, 0.997684226165, 0.997774927934, 0.997862080995, 0.997945823899, 0.998026289809, 0.998103606711, 0.998177897611, 0.998249280727, 0.998317869675, 0.998383773648, 0.998447097583, 0.998507942332, 0.998566404814, 0.998622578172, 0.998676551915, 0.998728412063, 0.998778241281, 0.998826119008, 0.998872121583, 0.998916322365, 0.998958791852, 0.998999597786, 0.999038805266, 0.999076476847, 0.999112672642, 0.999147450414, 0.999180865670, 0.999212971747, 0.999243819899, 0.999273459374,
                       0.999301937496, 0.999329299739
                     };
  static int nGrid = 401;
  static float hCstScale = 1250.000000000000;
  static float hCstGrid = 25.000000000000;

  // Asymtotic limits of the function for +- infinity
  if (x > X[nGrid - 1]) {
    return 1.0;
  } else if (x < X[0]) {
    return -1.0;
  }

  return QuadInterp(x, X, Y, nGrid, hCstScale, hCstGrid);
}



/* Computes the atan function by quadratic interpolation */
float Atan(float x) {

  // Data for quadratic interpolation of atan
  static float X[] = { -40.000000000000, -39.840000000000, -39.680000000000, -39.520000000000, -39.360000000000, -39.200000000000, -39.040000000000, -38.880000000000, -38.720000000000, -38.560000000000, -38.400000000000, -38.240000000000, -38.080000000000, -37.920000000000, -37.760000000000, -37.600000000000, -37.440000000000, -37.280000000000, -37.120000000000, -36.960000000000, -36.800000000000, -36.640000000000, -36.480000000000, -36.320000000000, -36.160000000000, -36.000000000000, -35.840000000000, -35.680000000000, -35.520000000000, -35.360000000000, -35.200000000000, -35.040000000000, -34.880000000000, -34.720000000000, -34.560000000000, -34.400000000000, -34.240000000000, -34.080000000000, -33.920000000000, -33.760000000000, -33.600000000000, -33.440000000000, -33.280000000000, -33.120000000000, -32.960000000000, -32.800000000000, -32.640000000000, -32.480000000000, -32.320000000000,
                       -32.160000000000, -32.000000000000, -31.840000000000, -31.680000000000, -31.520000000000, -31.360000000000, -31.200000000000, -31.040000000000, -30.880000000000, -30.720000000000, -30.560000000000, -30.400000000000, -30.240000000000, -30.080000000000, -29.920000000000, -29.760000000000, -29.600000000000, -29.440000000000, -29.280000000000, -29.120000000000, -28.960000000000, -28.800000000000, -28.640000000000, -28.480000000000, -28.320000000000, -28.160000000000, -28.000000000000, -27.840000000000, -27.680000000000, -27.520000000000, -27.360000000000, -27.200000000000, -27.040000000000, -26.880000000000, -26.720000000000, -26.560000000000, -26.400000000000, -26.240000000000, -26.080000000000, -25.920000000000, -25.760000000000, -25.600000000000, -25.440000000000, -25.280000000000, -25.120000000000, -24.960000000000, -24.800000000000, -24.640000000000, -24.480000000000, -24.320000000000,
                       -24.160000000000, -24.000000000000, -23.840000000000, -23.680000000000, -23.520000000000, -23.360000000000, -23.200000000000, -23.040000000000, -22.880000000000, -22.720000000000, -22.560000000000, -22.400000000000, -22.240000000000, -22.080000000000, -21.920000000000, -21.760000000000, -21.600000000000, -21.440000000000, -21.280000000000, -21.120000000000, -20.960000000000, -20.800000000000, -20.640000000000, -20.480000000000, -20.320000000000, -20.160000000000, -20.000000000000, -19.840000000000, -19.680000000000, -19.520000000000, -19.360000000000, -19.200000000000, -19.040000000000, -18.880000000000, -18.720000000000, -18.560000000000, -18.400000000000, -18.240000000000, -18.080000000000, -17.920000000000, -17.760000000000, -17.600000000000, -17.440000000000, -17.280000000000, -17.120000000000, -16.960000000000, -16.800000000000, -16.640000000000, -16.480000000000, -16.320000000000,
                       -16.160000000000, -16.000000000000, -15.840000000000, -15.680000000000, -15.520000000000, -15.360000000000, -15.200000000000, -15.040000000000, -14.880000000000, -14.720000000000, -14.560000000000, -14.400000000000, -14.240000000000, -14.080000000000, -13.920000000000, -13.760000000000, -13.600000000000, -13.440000000000, -13.280000000000, -13.120000000000, -12.960000000000, -12.800000000000, -12.640000000000, -12.480000000000, -12.320000000000, -12.160000000000, -12.000000000000, -11.840000000000, -11.680000000000, -11.520000000000, -11.360000000000, -11.200000000000, -11.040000000000, -10.880000000000, -10.720000000000, -10.560000000000, -10.400000000000, -10.240000000000, -10.080000000000, -9.920000000000, -9.760000000000, -9.600000000000, -9.440000000000, -9.280000000000, -9.120000000000, -8.960000000000, -8.800000000000, -8.640000000000, -8.480000000000, -8.320000000000,
                       -8.160000000000, -8.000000000000, -7.840000000000, -7.680000000000, -7.520000000000, -7.360000000000, -7.200000000000, -7.040000000000, -6.880000000000, -6.720000000000, -6.560000000000, -6.400000000000, -6.240000000000, -6.080000000000, -5.920000000000, -5.760000000000, -5.600000000000, -5.440000000000, -5.280000000000, -5.120000000000, -4.960000000000, -4.800000000000, -4.640000000000, -4.480000000000, -4.320000000000, -4.160000000000, -4.000000000000, -3.840000000000, -3.680000000000, -3.520000000000, -3.360000000000, -3.200000000000, -3.040000000000, -2.880000000000, -2.720000000000, -2.560000000000, -2.400000000000, -2.240000000000, -2.080000000000, -1.920000000000, -1.760000000000, -1.600000000000, -1.440000000000, -1.280000000000, -1.120000000000, -0.960000000000, -0.800000000000, -0.640000000000, -0.480000000000, -0.320000000000,
                       -0.160000000000, 0.000000000000, 0.160000000000, 0.320000000000, 0.480000000000, 0.640000000000, 0.800000000000, 0.960000000000, 1.120000000000, 1.280000000000, 1.440000000000, 1.600000000000, 1.760000000000, 1.920000000000, 2.080000000000, 2.240000000000, 2.400000000000, 2.560000000000, 2.720000000000, 2.880000000000, 3.040000000000, 3.200000000000, 3.360000000000, 3.520000000000, 3.680000000000, 3.840000000000, 4.000000000000, 4.160000000000, 4.320000000000, 4.480000000000, 4.640000000000, 4.800000000000, 4.960000000000, 5.120000000000, 5.280000000000, 5.440000000000, 5.600000000000, 5.760000000000, 5.920000000000, 6.080000000000, 6.240000000000, 6.400000000000, 6.560000000000, 6.720000000000, 6.880000000000, 7.040000000000, 7.200000000000, 7.360000000000, 7.520000000000, 7.680000000000,
                       7.840000000000, 8.000000000000, 8.160000000000, 8.320000000000, 8.480000000000, 8.640000000000, 8.800000000000, 8.960000000000, 9.120000000000, 9.280000000000, 9.440000000000, 9.600000000000, 9.760000000000, 9.920000000000, 10.080000000000, 10.240000000000, 10.400000000000, 10.560000000000, 10.720000000000, 10.880000000000, 11.040000000000, 11.200000000000, 11.360000000000, 11.520000000000, 11.680000000000, 11.840000000000, 12.000000000000, 12.160000000000, 12.320000000000, 12.480000000000, 12.640000000000, 12.800000000000, 12.960000000000, 13.120000000000, 13.280000000000, 13.440000000000, 13.600000000000, 13.760000000000, 13.920000000000, 14.080000000000, 14.240000000000, 14.400000000000, 14.560000000000, 14.720000000000, 14.880000000000, 15.040000000000, 15.200000000000, 15.360000000000, 15.520000000000, 15.680000000000,
                       15.840000000000, 16.000000000000, 16.160000000000, 16.320000000000, 16.480000000000, 16.640000000000, 16.800000000000, 16.960000000000, 17.120000000000, 17.280000000000, 17.440000000000, 17.600000000000, 17.760000000000, 17.920000000000, 18.080000000000, 18.240000000000, 18.400000000000, 18.560000000000, 18.720000000000, 18.880000000000, 19.040000000000, 19.200000000000, 19.360000000000, 19.520000000000, 19.680000000000, 19.840000000000, 20.000000000000, 20.160000000000, 20.320000000000, 20.480000000000, 20.640000000000, 20.800000000000, 20.960000000000, 21.120000000000, 21.280000000000, 21.440000000000, 21.600000000000, 21.760000000000, 21.920000000000, 22.080000000000, 22.240000000000, 22.400000000000, 22.560000000000, 22.720000000000, 22.880000000000, 23.040000000000, 23.200000000000, 23.360000000000, 23.520000000000, 23.680000000000,
                       23.840000000000, 24.000000000000, 24.160000000000, 24.320000000000, 24.480000000000, 24.640000000000, 24.800000000000, 24.960000000000, 25.120000000000, 25.280000000000, 25.440000000000, 25.600000000000, 25.760000000000, 25.920000000000, 26.080000000000, 26.240000000000, 26.400000000000, 26.560000000000, 26.720000000000, 26.880000000000, 27.040000000000, 27.200000000000, 27.360000000000, 27.520000000000, 27.680000000000, 27.840000000000, 28.000000000000, 28.160000000000, 28.320000000000, 28.480000000000, 28.640000000000, 28.800000000000, 28.960000000000, 29.120000000000, 29.280000000000, 29.440000000000, 29.600000000000, 29.760000000000, 29.920000000000, 30.080000000000, 30.240000000000, 30.400000000000, 30.560000000000, 30.720000000000, 30.880000000000, 31.040000000000, 31.200000000000, 31.360000000000, 31.520000000000, 31.680000000000,
                       31.840000000000, 32.000000000000, 32.160000000000, 32.320000000000, 32.480000000000, 32.640000000000, 32.800000000000, 32.960000000000, 33.120000000000, 33.280000000000, 33.440000000000, 33.600000000000, 33.760000000000, 33.920000000000, 34.080000000000, 34.240000000000, 34.400000000000, 34.560000000000, 34.720000000000, 34.880000000000, 35.040000000000, 35.200000000000, 35.360000000000, 35.520000000000, 35.680000000000, 35.840000000000, 36.000000000000, 36.160000000000, 36.320000000000, 36.480000000000, 36.640000000000, 36.800000000000, 36.960000000000, 37.120000000000, 37.280000000000, 37.440000000000, 37.600000000000, 37.760000000000, 37.920000000000, 38.080000000000, 38.240000000000, 38.400000000000, 38.560000000000, 38.720000000000, 38.880000000000, 39.040000000000, 39.200000000000, 39.360000000000, 39.520000000000, 39.680000000000,
                       39.840000000000, 40.000000000000
                     };
  static float Y[] = { -1.545801533176, -1.545701194533, -1.545600047220, -1.545498081421, -1.545395287166, -1.545291654316, -1.545187172572, -1.545081831462, -1.544975620343, -1.544868528393, -1.544760544613, -1.544651657817, -1.544541856635, -1.544431129501, -1.544319464657, -1.544206850142, -1.544093273794, -1.543978723239, -1.543863185893, -1.543746648952, -1.543629099391, -1.543510523956, -1.543390909164, -1.543270241292, -1.543148506376, -1.543025690201, -1.542901778303, -1.542776755956, -1.542650608170, -1.542523319683, -1.542394874956, -1.542265258169, -1.542134453209, -1.542002443668, -1.541869212835, -1.541734743686, -1.541599018883, -1.541462020759, -1.541323731317, -1.541184132219, -1.541043204776, -1.540900929945, -1.540757288315, -1.540612260100, -1.540465825134, -1.540317962854, -1.540168652296, -1.540017872085, -1.539865600422,
                       -1.539711815073, -1.539556493365, -1.539399612164, -1.539241147875, -1.539081076420, -1.538919373234, -1.538756013247, -1.538590970874, -1.538424220000, -1.538255733967, -1.538085485559, -1.537913446989, -1.537739589884, -1.537563885267, -1.537386303541, -1.537206814476, -1.537025387190, -1.536841990128, -1.536656591050, -1.536469157005, -1.536279654319, -1.536088048570, -1.535894304566, -1.535698386329, -1.535500257068, -1.535299879158, -1.535097214116, -1.534892222574, -1.534684864260, -1.534475097964, -1.534262881515, -1.534048171752, -1.533830924495, -1.533611094515, -1.533388635502, -1.533163500030, -1.532935639530, -1.532705004249, -1.532471543217, -1.532235204207, -1.531995933700, -1.531753676840, -1.531508377395, -1.531259977715, -1.531008418684, -1.530753639672, -1.530495578491, -1.530234171342, -1.529969352763, -1.529701055571,
                       -1.529429210812, -1.529153747696, -1.528874593541, -1.528591673702, -1.528304911513, -1.528014228212, -1.527719542871, -1.527420772321, -1.527117831073, -1.526810631240, -1.526499082448, -1.526183091749, -1.525862563529, -1.525537399414, -1.525207498165, -1.524872755578, -1.524533064371, -1.524188314070, -1.523838390892, -1.523483177619, -1.523122553466, -1.522756393947, -1.522384570729, -1.522006951485, -1.521623399738, -1.521233774694, -1.520837931073, -1.520435718928, -1.520026983455, -1.519611564800, -1.519189297842, -1.518760011986, -1.518323530924, -1.517879672402, -1.517428247963, -1.516969062682, -1.516501914887, -1.516026595864, -1.515542889551, -1.515050572203, -1.514549412059, -1.514039168973, -1.513519594032, -1.512990429156, -1.512451406672, -1.511902248861, -1.511342667486, -1.510772363291, -1.510191025465, -1.509598331086,
                       -1.508993944522, -1.508377516799, -1.507748684937, -1.507107071238, -1.506452282534, -1.505783909387, -1.505101525242, -1.504404685524, -1.503692926674, -1.502965765132, -1.502222696246, -1.501463193107, -1.500686705318, -1.499892657667, -1.499080448718, -1.498249449300, -1.497399000893, -1.496528413902, -1.495636965802, -1.494723899156, -1.493788419480, -1.492829692963, -1.491846844000, -1.490838952548, -1.489805051282, -1.488744122518, -1.487655094906, -1.486536839851, -1.485388167648, -1.484207823299, -1.482994481987, -1.481746744160, -1.480463130207, -1.479142074658, -1.477781919895, -1.476380909282, -1.474937179685, -1.473448753308, -1.471913528759, -1.470329271280, -1.468693602032, -1.467003986338, -1.465257720759, -1.463451918869, -1.461583495565, -1.459649149756, -1.457645345204, -1.455568289307, -1.453413909547, -1.451177827319,
                       -1.448855328766, -1.446441332248, -1.443930351964, -1.441316457193, -1.438593226540, -1.435753696448, -1.432790303137, -1.429694816971, -1.426458268089, -1.423070861920, -1.419521882960, -1.415799584871, -1.411891064614, -1.407782117857, -1.403457072380, -1.398898595499, -1.394087470725, -1.389002337847, -1.383619389355, -1.377912014537, -1.371850380590, -1.365400937605, -1.358525831079, -1.351182201618, -1.343321346322, -1.334887709726, -1.325817663668, -1.316038024359, -1.305464240586, -1.293998168163, -1.281525321186, -1.267911458420, -1.252998320985, -1.236598282529, -1.218487602121, -1.198397880118, -1.176005207095, -1.150916369589, -1.122651351719, -1.090621297191, -1.054101188033, -1.012197011451, -0.963808662748, -0.907593334089, -0.841941600342, -0.764992832711, -0.674740942224, -0.569313191101, -0.447519975157, -0.309702944542,
                       -0.158655262186, 0.000000000000, 0.158655262186, 0.309702944542, 0.447519975157, 0.569313191101, 0.674740942224, 0.764992832711, 0.841941600342, 0.907593334089, 0.963808662748, 1.012197011451, 1.054101188033, 1.090621297191, 1.122651351719, 1.150916369589, 1.176005207095, 1.198397880118, 1.218487602121, 1.236598282529, 1.252998320985, 1.267911458420, 1.281525321186, 1.293998168163, 1.305464240586, 1.316038024359, 1.325817663668, 1.334887709726, 1.343321346322, 1.351182201618, 1.358525831079, 1.365400937605, 1.371850380590, 1.377912014537, 1.383619389355, 1.389002337847, 1.394087470725, 1.398898595499, 1.403457072380, 1.407782117857, 1.411891064614, 1.415799584871, 1.419521882960, 1.423070861920, 1.426458268089, 1.429694816971, 1.432790303137, 1.435753696448, 1.438593226540, 1.441316457193,
                       1.443930351964, 1.446441332248, 1.448855328766, 1.451177827319, 1.453413909547, 1.455568289307, 1.457645345204, 1.459649149756, 1.461583495565, 1.463451918869, 1.465257720759, 1.467003986338, 1.468693602032, 1.470329271280, 1.471913528759, 1.473448753308, 1.474937179685, 1.476380909282, 1.477781919895, 1.479142074658, 1.480463130207, 1.481746744160, 1.482994481987, 1.484207823299, 1.485388167648, 1.486536839851, 1.487655094906, 1.488744122518, 1.489805051282, 1.490838952548, 1.491846844000, 1.492829692963, 1.493788419480, 1.494723899156, 1.495636965802, 1.496528413902, 1.497399000893, 1.498249449300, 1.499080448718, 1.499892657667, 1.500686705318, 1.501463193107, 1.502222696246, 1.502965765132, 1.503692926674, 1.504404685524, 1.505101525242, 1.505783909387, 1.506452282534, 1.507107071238,
                       1.507748684937, 1.508377516799, 1.508993944522, 1.509598331086, 1.510191025465, 1.510772363291, 1.511342667486, 1.511902248861, 1.512451406672, 1.512990429156, 1.513519594032, 1.514039168973, 1.514549412059, 1.515050572203, 1.515542889551, 1.516026595864, 1.516501914887, 1.516969062682, 1.517428247963, 1.517879672402, 1.518323530924, 1.518760011986, 1.519189297842, 1.519611564800, 1.520026983455, 1.520435718928, 1.520837931073, 1.521233774694, 1.521623399738, 1.522006951485, 1.522384570729, 1.522756393947, 1.523122553466, 1.523483177619, 1.523838390892, 1.524188314070, 1.524533064371, 1.524872755578, 1.525207498165, 1.525537399414, 1.525862563529, 1.526183091749, 1.526499082448, 1.526810631240, 1.527117831073, 1.527420772321, 1.527719542871, 1.528014228212, 1.528304911513, 1.528591673702,
                       1.528874593541, 1.529153747696, 1.529429210812, 1.529701055571, 1.529969352763, 1.530234171342, 1.530495578491, 1.530753639672, 1.531008418684, 1.531259977715, 1.531508377395, 1.531753676840, 1.531995933700, 1.532235204207, 1.532471543217, 1.532705004249, 1.532935639530, 1.533163500030, 1.533388635502, 1.533611094515, 1.533830924495, 1.534048171752, 1.534262881515, 1.534475097964, 1.534684864260, 1.534892222574, 1.535097214116, 1.535299879158, 1.535500257068, 1.535698386329, 1.535894304566, 1.536088048570, 1.536279654319, 1.536469157005, 1.536656591050, 1.536841990128, 1.537025387190, 1.537206814476, 1.537386303541, 1.537563885267, 1.537739589884, 1.537913446989, 1.538085485559, 1.538255733967, 1.538424220000, 1.538590970874, 1.538756013247, 1.538919373234, 1.539081076420, 1.539241147875,
                       1.539399612164, 1.539556493365, 1.539711815073, 1.539865600422, 1.540017872085, 1.540168652296, 1.540317962854, 1.540465825134, 1.540612260100, 1.540757288315, 1.540900929945, 1.541043204776, 1.541184132219, 1.541323731317, 1.541462020759, 1.541599018883, 1.541734743686, 1.541869212835, 1.542002443668, 1.542134453209, 1.542265258169, 1.542394874956, 1.542523319683, 1.542650608170, 1.542776755956, 1.542901778303, 1.543025690201, 1.543148506376, 1.543270241292, 1.543390909164, 1.543510523956, 1.543629099391, 1.543746648952, 1.543863185893, 1.543978723239, 1.544093273794, 1.544206850142, 1.544319464657, 1.544431129501, 1.544541856635, 1.544651657817, 1.544760544613, 1.544868528393, 1.544975620343, 1.545081831462, 1.545187172572, 1.545291654316, 1.545395287166, 1.545498081421, 1.545600047220,
                       1.545701194533, 1.545801533176
                     };
  static int nGrid = 501;
  static float hCstScale = 19.531250000000;
  static float hCstGrid = 3.125000000000;

  return QuadInterp(x, X, Y, nGrid, hCstScale, hCstGrid);
}



/* Computes the sine function by quadratic interpolation */
float Sin(float x) {

// Data for quadratic interpolation of sin
  static float X[] = {0.000000000000, 0.012566370614, 0.025132741229, 0.037699111843, 0.050265482457, 0.062831853072, 0.075398223686, 0.087964594301, 0.100530964915, 0.113097335529, 0.125663706144, 0.138230076758, 0.150796447372, 0.163362817987, 0.175929188601, 0.188495559215, 0.201061929830, 0.213628300444, 0.226194671058, 0.238761041673, 0.251327412287, 0.263893782902, 0.276460153516, 0.289026524130, 0.301592894745, 0.314159265359, 0.326725635973, 0.339292006588, 0.351858377202, 0.364424747816, 0.376991118431, 0.389557489045, 0.402123859659, 0.414690230274, 0.427256600888, 0.439822971503, 0.452389342117, 0.464955712731, 0.477522083346, 0.490088453960, 0.502654824574, 0.515221195189, 0.527787565803, 0.540353936417, 0.552920307032, 0.565486677646, 0.578053048261, 0.590619418875, 0.603185789489,
                      0.615752160104, 0.628318530718, 0.640884901332, 0.653451271947, 0.666017642561, 0.678584013175, 0.691150383790, 0.703716754404, 0.716283125018, 0.728849495633, 0.741415866247, 0.753982236862, 0.766548607476, 0.779114978090, 0.791681348705, 0.804247719319, 0.816814089933, 0.829380460548, 0.841946831162, 0.854513201776, 0.867079572391, 0.879645943005, 0.892212313620, 0.904778684234, 0.917345054848, 0.929911425463, 0.942477796077, 0.955044166691, 0.967610537306, 0.980176907920, 0.992743278534, 1.005309649149, 1.017876019763, 1.030442390377, 1.043008760992, 1.055575131606, 1.068141502221, 1.080707872835, 1.093274243449, 1.105840614064, 1.118406984678, 1.130973355292, 1.143539725907, 1.156106096521, 1.168672467135, 1.181238837750, 1.193805208364, 1.206371578978, 1.218937949593, 1.231504320207,
                      1.244070690822, 1.256637061436, 1.269203432050, 1.281769802665, 1.294336173279, 1.306902543893, 1.319468914508, 1.332035285122, 1.344601655736, 1.357168026351, 1.369734396965, 1.382300767580, 1.394867138194, 1.407433508808, 1.419999879423, 1.432566250037, 1.445132620651, 1.457698991266, 1.470265361880, 1.482831732494, 1.495398103109, 1.507964473723, 1.520530844337, 1.533097214952, 1.545663585566, 1.558229956181, 1.570796326795, 1.583362697409, 1.595929068024, 1.608495438638, 1.621061809252, 1.633628179867, 1.646194550481, 1.658760921095, 1.671327291710, 1.683893662324, 1.696460032938, 1.709026403553, 1.721592774167, 1.734159144782, 1.746725515396, 1.759291886010, 1.771858256625, 1.784424627239, 1.796990997853, 1.809557368468, 1.822123739082, 1.834690109696, 1.847256480311, 1.859822850925,
                      1.872389221540, 1.884955592154, 1.897521962768, 1.910088333383, 1.922654703997, 1.935221074611, 1.947787445226, 1.960353815840, 1.972920186454, 1.985486557069, 1.998052927683, 2.010619298297, 2.023185668912, 2.035752039526, 2.048318410141, 2.060884780755, 2.073451151369, 2.086017521984, 2.098583892598, 2.111150263212, 2.123716633827, 2.136283004441, 2.148849375055, 2.161415745670, 2.173982116284, 2.186548486898, 2.199114857513, 2.211681228127, 2.224247598742, 2.236813969356, 2.249380339970, 2.261946710585, 2.274513081199, 2.287079451813, 2.299645822428, 2.312212193042, 2.324778563656, 2.337344934271, 2.349911304885, 2.362477675500, 2.375044046114, 2.387610416728, 2.400176787343, 2.412743157957, 2.425309528571, 2.437875899186, 2.450442269800, 2.463008640414, 2.475575011029, 2.488141381643,
                      2.500707752257, 2.513274122872, 2.525840493486, 2.538406864101, 2.550973234715, 2.563539605329, 2.576105975944, 2.588672346558, 2.601238717172, 2.613805087787, 2.626371458401, 2.638937829015, 2.651504199630, 2.664070570244, 2.676636940859, 2.689203311473, 2.701769682087, 2.714336052702, 2.726902423316, 2.739468793930, 2.752035164545, 2.764601535159, 2.777167905773, 2.789734276388, 2.802300647002, 2.814867017616, 2.827433388231, 2.839999758845, 2.852566129460, 2.865132500074, 2.877698870688, 2.890265241303, 2.902831611917, 2.915397982531, 2.927964353146, 2.940530723760, 2.953097094374, 2.965663464989, 2.978229835603, 2.990796206217, 3.003362576832, 3.015928947446, 3.028495318061, 3.041061688675, 3.053628059289, 3.066194429904, 3.078760800518, 3.091327171132, 3.103893541747, 3.116459912361,
                      3.129026282975, 3.141592653590, 3.154159024204, 3.166725394819, 3.179291765433, 3.191858136047, 3.204424506662, 3.216990877276, 3.229557247890, 3.242123618505, 3.254689989119, 3.267256359733, 3.279822730348, 3.292389100962, 3.304955471576, 3.317521842191, 3.330088212805, 3.342654583420, 3.355220954034, 3.367787324648, 3.380353695263, 3.392920065877, 3.405486436491, 3.418052807106, 3.430619177720, 3.443185548334, 3.455751918949, 3.468318289563, 3.480884660177, 3.493451030792, 3.506017401406, 3.518583772021, 3.531150142635, 3.543716513249, 3.556282883864, 3.568849254478, 3.581415625092, 3.593981995707, 3.606548366321, 3.619114736935, 3.631681107550, 3.644247478164, 3.656813848779, 3.669380219393, 3.681946590007, 3.694512960622, 3.707079331236, 3.719645701850, 3.732212072465, 3.744778443079,
                      3.757344813693, 3.769911184308, 3.782477554922, 3.795043925536, 3.807610296151, 3.820176666765, 3.832743037380, 3.845309407994, 3.857875778608, 3.870442149223, 3.883008519837, 3.895574890451, 3.908141261066, 3.920707631680, 3.933274002294, 3.945840372909, 3.958406743523, 3.970973114137, 3.983539484752, 3.996105855366, 4.008672225981, 4.021238596595, 4.033804967209, 4.046371337824, 4.058937708438, 4.071504079052, 4.084070449667, 4.096636820281, 4.109203190895, 4.121769561510, 4.134335932124, 4.146902302739, 4.159468673353, 4.172035043967, 4.184601414582, 4.197167785196, 4.209734155810, 4.222300526425, 4.234866897039, 4.247433267653, 4.259999638268, 4.272566008882, 4.285132379496, 4.297698750111, 4.310265120725, 4.322831491340, 4.335397861954, 4.347964232568, 4.360530603183, 4.373096973797,
                      4.385663344411, 4.398229715026, 4.410796085640, 4.423362456254, 4.435928826869, 4.448495197483, 4.461061568098, 4.473627938712, 4.486194309326, 4.498760679941, 4.511327050555, 4.523893421169, 4.536459791784, 4.549026162398, 4.561592533012, 4.574158903627, 4.586725274241, 4.599291644855, 4.611858015470, 4.624424386084, 4.636990756699, 4.649557127313, 4.662123497927, 4.674689868542, 4.687256239156, 4.699822609770, 4.712388980385, 4.724955350999, 4.737521721613, 4.750088092228, 4.762654462842, 4.775220833456, 4.787787204071, 4.800353574685, 4.812919945300, 4.825486315914, 4.838052686528, 4.850619057143, 4.863185427757, 4.875751798371, 4.888318168986, 4.900884539600, 4.913450910214, 4.926017280829, 4.938583651443, 4.951150022058, 4.963716392672, 4.976282763286, 4.988849133901, 5.001415504515,
                      5.013981875129, 5.026548245744, 5.039114616358, 5.051680986972, 5.064247357587, 5.076813728201, 5.089380098815, 5.101946469430, 5.114512840044, 5.127079210659, 5.139645581273, 5.152211951887, 5.164778322502, 5.177344693116, 5.189911063730, 5.202477434345, 5.215043804959, 5.227610175573, 5.240176546188, 5.252742916802, 5.265309287416, 5.277875658031, 5.290442028645, 5.303008399260, 5.315574769874, 5.328141140488, 5.340707511103, 5.353273881717, 5.365840252331, 5.378406622946, 5.390972993560, 5.403539364174, 5.416105734789, 5.428672105403, 5.441238476018, 5.453804846632, 5.466371217246, 5.478937587861, 5.491503958475, 5.504070329089, 5.516636699704, 5.529203070318, 5.541769440932, 5.554335811547, 5.566902182161, 5.579468552775, 5.592034923390, 5.604601294004, 5.617167664619, 5.629734035233,
                      5.642300405847, 5.654866776462, 5.667433147076, 5.679999517690, 5.692565888305, 5.705132258919, 5.717698629533, 5.730265000148, 5.742831370762, 5.755397741377, 5.767964111991, 5.780530482605, 5.793096853220, 5.805663223834, 5.818229594448, 5.830795965063, 5.843362335677, 5.855928706291, 5.868495076906, 5.881061447520, 5.893627818134, 5.906194188749, 5.918760559363, 5.931326929978, 5.943893300592, 5.956459671206, 5.969026041821, 5.981592412435, 5.994158783049, 6.006725153664, 6.019291524278, 6.031857894892, 6.044424265507, 6.056990636121, 6.069557006735, 6.082123377350, 6.094689747964, 6.107256118579, 6.119822489193, 6.132388859807, 6.144955230422, 6.157521601036, 6.170087971650, 6.182654342265, 6.195220712879, 6.207787083493, 6.220353454108, 6.232919824722, 6.245486195337, 6.258052565951,
                      6.270618936565, 6.283185307180
                     };
  static float Y[] = {0.000000000000, 0.012566039883, 0.025130095443, 0.037690182670, 0.050244318180, 0.062790519529, 0.075326805528, 0.087851196551, 0.100361714851, 0.112856384873, 0.125333233564, 0.137790290685, 0.150225589121, 0.162637165195, 0.175023058975, 0.187381314586, 0.199709980514, 0.212007109922, 0.224270760949, 0.236498997024, 0.248689887165, 0.260841506290, 0.272951935517, 0.285019262470, 0.297041581577, 0.309016994375, 0.320943609807, 0.332819544523, 0.344642923175, 0.356411878713, 0.368124552685, 0.379779095522, 0.391373666837, 0.402906435714, 0.414375580993, 0.425779291565, 0.437115766651, 0.448383216090, 0.459579860621, 0.470703932165, 0.481753674102, 0.492727341548, 0.503623201636, 0.514439533782, 0.525174629961, 0.535826794979, 0.546394346734, 0.556875616488, 0.567268949127,
                      0.577572703422, 0.587785252292, 0.597904983058, 0.607930297695, 0.617859613090, 0.627691361291, 0.637423989749, 0.647055961569, 0.656585755753, 0.666011867434, 0.675332808121, 0.684547105929, 0.693653305813, 0.702649969799, 0.711535677209, 0.720309024888, 0.728968627421, 0.737513117358, 0.745941145424, 0.754251380736, 0.762442511011, 0.770513242776, 0.778462301567, 0.786288432137, 0.793990398648, 0.801566984871, 0.809016994375, 0.816339250717, 0.823532597628, 0.830595899196, 0.837528040042, 0.844327925502, 0.850994481795, 0.857526656194, 0.863923417193, 0.870183754670, 0.876306680044, 0.882291226435, 0.888136448814, 0.893841424151, 0.899405251566, 0.904827052466, 0.910105970685, 0.915241172621, 0.920231847366, 0.925077206834, 0.929776485888, 0.934328942457, 0.938733857654, 0.942990535893,
                      0.947098304995, 0.951056516295, 0.954864544747, 0.958521789017, 0.962027671586, 0.965381638833, 0.968583161129, 0.971631732915, 0.974526872787, 0.977268123568, 0.979855052384, 0.982287250729, 0.984564334529, 0.986685944208, 0.988651744738, 0.990461425697, 0.992114701314, 0.993611310520, 0.994951016981, 0.996133609143, 0.997158900261, 0.998026728428, 0.998736956606, 0.999289472641, 0.999684189283, 0.999921044204, 1.000000000000, 0.999921044204, 0.999684189283, 0.999289472641, 0.998736956606, 0.998026728428, 0.997158900261, 0.996133609143, 0.994951016981, 0.993611310520, 0.992114701314, 0.990461425697, 0.988651744738, 0.986685944208, 0.984564334529, 0.982287250729, 0.979855052384, 0.977268123568, 0.974526872787, 0.971631732915, 0.968583161129, 0.965381638833, 0.962027671586, 0.958521789017,
                      0.954864544747, 0.951056516295, 0.947098304995, 0.942990535893, 0.938733857654, 0.934328942457, 0.929776485888, 0.925077206834, 0.920231847366, 0.915241172621, 0.910105970685, 0.904827052466, 0.899405251566, 0.893841424151, 0.888136448814, 0.882291226435, 0.876306680044, 0.870183754670, 0.863923417193, 0.857526656194, 0.850994481795, 0.844327925502, 0.837528040042, 0.830595899196, 0.823532597628, 0.816339250717, 0.809016994375, 0.801566984871, 0.793990398648, 0.786288432137, 0.778462301567, 0.770513242776, 0.762442511011, 0.754251380736, 0.745941145424, 0.737513117358, 0.728968627421, 0.720309024888, 0.711535677209, 0.702649969799, 0.693653305813, 0.684547105929, 0.675332808121, 0.666011867434, 0.656585755753, 0.647055961569, 0.637423989749, 0.627691361291, 0.617859613090, 0.607930297695,
                      0.597904983058, 0.587785252292, 0.577572703422, 0.567268949127, 0.556875616488, 0.546394346734, 0.535826794979, 0.525174629961, 0.514439533782, 0.503623201636, 0.492727341548, 0.481753674102, 0.470703932165, 0.459579860621, 0.448383216090, 0.437115766651, 0.425779291565, 0.414375580993, 0.402906435714, 0.391373666837, 0.379779095522, 0.368124552685, 0.356411878713, 0.344642923175, 0.332819544523, 0.320943609807, 0.309016994375, 0.297041581577, 0.285019262470, 0.272951935517, 0.260841506290, 0.248689887165, 0.236498997024, 0.224270760949, 0.212007109922, 0.199709980514, 0.187381314586, 0.175023058975, 0.162637165195, 0.150225589121, 0.137790290685, 0.125333233564, 0.112856384873, 0.100361714851, 0.087851196551, 0.075326805528, 0.062790519529, 0.050244318180, 0.037690182670, 0.025130095443,
                      0.012566039883, 0.000000000000, -0.012566039883, -0.025130095443, -0.037690182670, -0.050244318180, -0.062790519529, -0.075326805528, -0.087851196551, -0.100361714851, -0.112856384873, -0.125333233564, -0.137790290685, -0.150225589121, -0.162637165195, -0.175023058975, -0.187381314586, -0.199709980514, -0.212007109922, -0.224270760949, -0.236498997024, -0.248689887165, -0.260841506290, -0.272951935517, -0.285019262470, -0.297041581577, -0.309016994375, -0.320943609807, -0.332819544523, -0.344642923175, -0.356411878713, -0.368124552685, -0.379779095522, -0.391373666837, -0.402906435714, -0.414375580993, -0.425779291565, -0.437115766651, -0.448383216090, -0.459579860621, -0.470703932165, -0.481753674102, -0.492727341548, -0.503623201636, -0.514439533782, -0.525174629961, -0.535826794979, -0.546394346734, -0.556875616488, -0.567268949127,
                      -0.577572703422, -0.587785252292, -0.597904983058, -0.607930297695, -0.617859613090, -0.627691361291, -0.637423989749, -0.647055961569, -0.656585755753, -0.666011867434, -0.675332808121, -0.684547105929, -0.693653305813, -0.702649969799, -0.711535677209, -0.720309024888, -0.728968627421, -0.737513117358, -0.745941145424, -0.754251380736, -0.762442511011, -0.770513242776, -0.778462301567, -0.786288432137, -0.793990398648, -0.801566984871, -0.809016994375, -0.816339250717, -0.823532597628, -0.830595899196, -0.837528040042, -0.844327925502, -0.850994481795, -0.857526656194, -0.863923417193, -0.870183754670, -0.876306680044, -0.882291226435, -0.888136448814, -0.893841424151, -0.899405251566, -0.904827052466, -0.910105970685, -0.915241172621, -0.920231847366, -0.925077206834, -0.929776485888, -0.934328942457, -0.938733857654, -0.942990535893,
                      -0.947098304995, -0.951056516295, -0.954864544747, -0.958521789017, -0.962027671586, -0.965381638833, -0.968583161129, -0.971631732915, -0.974526872787, -0.977268123568, -0.979855052384, -0.982287250729, -0.984564334529, -0.986685944208, -0.988651744738, -0.990461425697, -0.992114701314, -0.993611310520, -0.994951016981, -0.996133609143, -0.997158900261, -0.998026728428, -0.998736956606, -0.999289472641, -0.999684189283, -0.999921044204, -1.000000000000, -0.999921044204, -0.999684189283, -0.999289472641, -0.998736956606, -0.998026728428, -0.997158900261, -0.996133609143, -0.994951016981, -0.993611310520, -0.992114701314, -0.990461425697, -0.988651744738, -0.986685944208, -0.984564334529, -0.982287250729, -0.979855052384, -0.977268123568, -0.974526872787, -0.971631732915, -0.968583161129, -0.965381638833, -0.962027671586, -0.958521789017,
                      -0.954864544747, -0.951056516295, -0.947098304995, -0.942990535893, -0.938733857654, -0.934328942457, -0.929776485888, -0.925077206834, -0.920231847366, -0.915241172621, -0.910105970685, -0.904827052466, -0.899405251566, -0.893841424151, -0.888136448814, -0.882291226435, -0.876306680044, -0.870183754670, -0.863923417193, -0.857526656194, -0.850994481795, -0.844327925502, -0.837528040042, -0.830595899196, -0.823532597628, -0.816339250717, -0.809016994375, -0.801566984871, -0.793990398648, -0.786288432137, -0.778462301567, -0.770513242776, -0.762442511011, -0.754251380736, -0.745941145424, -0.737513117358, -0.728968627421, -0.720309024888, -0.711535677209, -0.702649969799, -0.693653305813, -0.684547105929, -0.675332808121, -0.666011867434, -0.656585755753, -0.647055961569, -0.637423989749, -0.627691361291, -0.617859613090, -0.607930297695,
                      -0.597904983058, -0.587785252292, -0.577572703422, -0.567268949127, -0.556875616488, -0.546394346734, -0.535826794979, -0.525174629961, -0.514439533782, -0.503623201636, -0.492727341548, -0.481753674102, -0.470703932165, -0.459579860621, -0.448383216090, -0.437115766651, -0.425779291565, -0.414375580993, -0.402906435714, -0.391373666837, -0.379779095522, -0.368124552685, -0.356411878713, -0.344642923175, -0.332819544523, -0.320943609807, -0.309016994375, -0.297041581577, -0.285019262470, -0.272951935517, -0.260841506290, -0.248689887165, -0.236498997024, -0.224270760949, -0.212007109922, -0.199709980514, -0.187381314586, -0.175023058975, -0.162637165195, -0.150225589121, -0.137790290685, -0.125333233564, -0.112856384873, -0.100361714851, -0.087851196551, -0.075326805528, -0.062790519529, -0.050244318180, -0.037690182670, -0.025130095443,
                      -0.012566039883, -0.000000000000
                     };
  static int nGrid = 501;
  static float hCstScale = 3166.286988823055;
  static float hCstGrid = 39.788735772974;

  // Wrap to the correct domain:
  if (x < X[0]) {
    x = x + ((int)((X[nGrid - 1] - x) * INV_TWO_PI)) * TWO_PI;
  } else if (x > X[nGrid - 1]) {
    x = x - ((int)((x - X[0]) * INV_TWO_PI)) * TWO_PI;
  }

  return QuadInterp(x, X, Y, nGrid, hCstScale, hCstGrid);
}



/* Computes the cosine function by quadratic interpolation */
float Cos(float x) {
  return Sin(x + HALF_PI);
}



/* Computes the tangent function by quadratic interpolation.
 * Does not check against divide by zero errors!
 */
float Tan(float x) {
  return Sin(x) / Cos(x);
}



/* Computes the square-root function by quadratic interpolation.
 * Valid range is (0,10)
 */
float Sqrt(float x) {

// Data for quadratic interpolation of sqrt
  static float X[] = {0.000000000000, 0.012500000000, 0.025000000000, 0.037500000000, 0.050000000000, 0.062500000000, 0.075000000000, 0.087500000000, 0.100000000000, 0.112500000000, 0.125000000000, 0.137500000000, 0.150000000000, 0.162500000000, 0.175000000000, 0.187500000000, 0.200000000000, 0.212500000000, 0.225000000000, 0.237500000000, 0.250000000000, 0.262500000000, 0.275000000000, 0.287500000000, 0.300000000000, 0.312500000000, 0.325000000000, 0.337500000000, 0.350000000000, 0.362500000000, 0.375000000000, 0.387500000000, 0.400000000000, 0.412500000000, 0.425000000000, 0.437500000000, 0.450000000000, 0.462500000000, 0.475000000000, 0.487500000000, 0.500000000000, 0.512500000000, 0.525000000000, 0.537500000000, 0.550000000000, 0.562500000000, 0.575000000000, 0.587500000000, 0.600000000000,
                      0.612500000000, 0.625000000000, 0.637500000000, 0.650000000000, 0.662500000000, 0.675000000000, 0.687500000000, 0.700000000000, 0.712500000000, 0.725000000000, 0.737500000000, 0.750000000000, 0.762500000000, 0.775000000000, 0.787500000000, 0.800000000000, 0.812500000000, 0.825000000000, 0.837500000000, 0.850000000000, 0.862500000000, 0.875000000000, 0.887500000000, 0.900000000000, 0.912500000000, 0.925000000000, 0.937500000000, 0.950000000000, 0.962500000000, 0.975000000000, 0.987500000000, 1.000000000000, 1.012500000000, 1.025000000000, 1.037500000000, 1.050000000000, 1.062500000000, 1.075000000000, 1.087500000000, 1.100000000000, 1.112500000000, 1.125000000000, 1.137500000000, 1.150000000000, 1.162500000000, 1.175000000000, 1.187500000000, 1.200000000000, 1.212500000000, 1.225000000000,
                      1.237500000000, 1.250000000000, 1.262500000000, 1.275000000000, 1.287500000000, 1.300000000000, 1.312500000000, 1.325000000000, 1.337500000000, 1.350000000000, 1.362500000000, 1.375000000000, 1.387500000000, 1.400000000000, 1.412500000000, 1.425000000000, 1.437500000000, 1.450000000000, 1.462500000000, 1.475000000000, 1.487500000000, 1.500000000000, 1.512500000000, 1.525000000000, 1.537500000000, 1.550000000000, 1.562500000000, 1.575000000000, 1.587500000000, 1.600000000000, 1.612500000000, 1.625000000000, 1.637500000000, 1.650000000000, 1.662500000000, 1.675000000000, 1.687500000000, 1.700000000000, 1.712500000000, 1.725000000000, 1.737500000000, 1.750000000000, 1.762500000000, 1.775000000000, 1.787500000000, 1.800000000000, 1.812500000000, 1.825000000000, 1.837500000000, 1.850000000000,
                      1.862500000000, 1.875000000000, 1.887500000000, 1.900000000000, 1.912500000000, 1.925000000000, 1.937500000000, 1.950000000000, 1.962500000000, 1.975000000000, 1.987500000000, 2.000000000000, 2.012500000000, 2.025000000000, 2.037500000000, 2.050000000000, 2.062500000000, 2.075000000000, 2.087500000000, 2.100000000000, 2.112500000000, 2.125000000000, 2.137500000000, 2.150000000000, 2.162500000000, 2.175000000000, 2.187500000000, 2.200000000000, 2.212500000000, 2.225000000000, 2.237500000000, 2.250000000000, 2.262500000000, 2.275000000000, 2.287500000000, 2.300000000000, 2.312500000000, 2.325000000000, 2.337500000000, 2.350000000000, 2.362500000000, 2.375000000000, 2.387500000000, 2.400000000000, 2.412500000000, 2.425000000000, 2.437500000000, 2.450000000000, 2.462500000000, 2.475000000000,
                      2.487500000000, 2.500000000000, 2.512500000000, 2.525000000000, 2.537500000000, 2.550000000000, 2.562500000000, 2.575000000000, 2.587500000000, 2.600000000000, 2.612500000000, 2.625000000000, 2.637500000000, 2.650000000000, 2.662500000000, 2.675000000000, 2.687500000000, 2.700000000000, 2.712500000000, 2.725000000000, 2.737500000000, 2.750000000000, 2.762500000000, 2.775000000000, 2.787500000000, 2.800000000000, 2.812500000000, 2.825000000000, 2.837500000000, 2.850000000000, 2.862500000000, 2.875000000000, 2.887500000000, 2.900000000000, 2.912500000000, 2.925000000000, 2.937500000000, 2.950000000000, 2.962500000000, 2.975000000000, 2.987500000000, 3.000000000000, 3.012500000000, 3.025000000000, 3.037500000000, 3.050000000000, 3.062500000000, 3.075000000000, 3.087500000000, 3.100000000000,
                      3.112500000000, 3.125000000000, 3.137500000000, 3.150000000000, 3.162500000000, 3.175000000000, 3.187500000000, 3.200000000000, 3.212500000000, 3.225000000000, 3.237500000000, 3.250000000000, 3.262500000000, 3.275000000000, 3.287500000000, 3.300000000000, 3.312500000000, 3.325000000000, 3.337500000000, 3.350000000000, 3.362500000000, 3.375000000000, 3.387500000000, 3.400000000000, 3.412500000000, 3.425000000000, 3.437500000000, 3.450000000000, 3.462500000000, 3.475000000000, 3.487500000000, 3.500000000000, 3.512500000000, 3.525000000000, 3.537500000000, 3.550000000000, 3.562500000000, 3.575000000000, 3.587500000000, 3.600000000000, 3.612500000000, 3.625000000000, 3.637500000000, 3.650000000000, 3.662500000000, 3.675000000000, 3.687500000000, 3.700000000000, 3.712500000000, 3.725000000000,
                      3.737500000000, 3.750000000000, 3.762500000000, 3.775000000000, 3.787500000000, 3.800000000000, 3.812500000000, 3.825000000000, 3.837500000000, 3.850000000000, 3.862500000000, 3.875000000000, 3.887500000000, 3.900000000000, 3.912500000000, 3.925000000000, 3.937500000000, 3.950000000000, 3.962500000000, 3.975000000000, 3.987500000000, 4.000000000000, 4.012500000000, 4.025000000000, 4.037500000000, 4.050000000000, 4.062500000000, 4.075000000000, 4.087500000000, 4.100000000000, 4.112500000000, 4.125000000000, 4.137500000000, 4.150000000000, 4.162500000000, 4.175000000000, 4.187500000000, 4.200000000000, 4.212500000000, 4.225000000000, 4.237500000000, 4.250000000000, 4.262500000000, 4.275000000000, 4.287500000000, 4.300000000000, 4.312500000000, 4.325000000000, 4.337500000000, 4.350000000000,
                      4.362500000000, 4.375000000000, 4.387500000000, 4.400000000000, 4.412500000000, 4.425000000000, 4.437500000000, 4.450000000000, 4.462500000000, 4.475000000000, 4.487500000000, 4.500000000000, 4.512500000000, 4.525000000000, 4.537500000000, 4.550000000000, 4.562500000000, 4.575000000000, 4.587500000000, 4.600000000000, 4.612500000000, 4.625000000000, 4.637500000000, 4.650000000000, 4.662500000000, 4.675000000000, 4.687500000000, 4.700000000000, 4.712500000000, 4.725000000000, 4.737500000000, 4.750000000000, 4.762500000000, 4.775000000000, 4.787500000000, 4.800000000000, 4.812500000000, 4.825000000000, 4.837500000000, 4.850000000000, 4.862500000000, 4.875000000000, 4.887500000000, 4.900000000000, 4.912500000000, 4.925000000000, 4.937500000000, 4.950000000000, 4.962500000000, 4.975000000000,
                      4.987500000000, 5.000000000000, 5.012500000000, 5.025000000000, 5.037500000000, 5.050000000000, 5.062500000000, 5.075000000000, 5.087500000000, 5.100000000000, 5.112500000000, 5.125000000000, 5.137500000000, 5.150000000000, 5.162500000000, 5.175000000000, 5.187500000000, 5.200000000000, 5.212500000000, 5.225000000000, 5.237500000000, 5.250000000000, 5.262500000000, 5.275000000000, 5.287500000000, 5.300000000000, 5.312500000000, 5.325000000000, 5.337500000000, 5.350000000000, 5.362500000000, 5.375000000000, 5.387500000000, 5.400000000000, 5.412500000000, 5.425000000000, 5.437500000000, 5.450000000000, 5.462500000000, 5.475000000000, 5.487500000000, 5.500000000000, 5.512500000000, 5.525000000000, 5.537500000000, 5.550000000000, 5.562500000000, 5.575000000000, 5.587500000000, 5.600000000000,
                      5.612500000000, 5.625000000000, 5.637500000000, 5.650000000000, 5.662500000000, 5.675000000000, 5.687500000000, 5.700000000000, 5.712500000000, 5.725000000000, 5.737500000000, 5.750000000000, 5.762500000000, 5.775000000000, 5.787500000000, 5.800000000000, 5.812500000000, 5.825000000000, 5.837500000000, 5.850000000000, 5.862500000000, 5.875000000000, 5.887500000000, 5.900000000000, 5.912500000000, 5.925000000000, 5.937500000000, 5.950000000000, 5.962500000000, 5.975000000000, 5.987500000000, 6.000000000000, 6.012500000000, 6.025000000000, 6.037500000000, 6.050000000000, 6.062500000000, 6.075000000000, 6.087500000000, 6.100000000000, 6.112500000000, 6.125000000000, 6.137500000000, 6.150000000000, 6.162500000000, 6.175000000000, 6.187500000000, 6.200000000000, 6.212500000000, 6.225000000000,
                      6.237500000000, 6.250000000000, 6.262500000000, 6.275000000000, 6.287500000000, 6.300000000000, 6.312500000000, 6.325000000000, 6.337500000000, 6.350000000000, 6.362500000000, 6.375000000000, 6.387500000000, 6.400000000000, 6.412500000000, 6.425000000000, 6.437500000000, 6.450000000000, 6.462500000000, 6.475000000000, 6.487500000000, 6.500000000000, 6.512500000000, 6.525000000000, 6.537500000000, 6.550000000000, 6.562500000000, 6.575000000000, 6.587500000000, 6.600000000000, 6.612500000000, 6.625000000000, 6.637500000000, 6.650000000000, 6.662500000000, 6.675000000000, 6.687500000000, 6.700000000000, 6.712500000000, 6.725000000000, 6.737500000000, 6.750000000000, 6.762500000000, 6.775000000000, 6.787500000000, 6.800000000000, 6.812500000000, 6.825000000000, 6.837500000000, 6.850000000000,
                      6.862500000000, 6.875000000000, 6.887500000000, 6.900000000000, 6.912500000000, 6.925000000000, 6.937500000000, 6.950000000000, 6.962500000000, 6.975000000000, 6.987500000000, 7.000000000000, 7.012500000000, 7.025000000000, 7.037500000000, 7.050000000000, 7.062500000000, 7.075000000000, 7.087500000000, 7.100000000000, 7.112500000000, 7.125000000000, 7.137500000000, 7.150000000000, 7.162500000000, 7.175000000000, 7.187500000000, 7.200000000000, 7.212500000000, 7.225000000000, 7.237500000000, 7.250000000000, 7.262500000000, 7.275000000000, 7.287500000000, 7.300000000000, 7.312500000000, 7.325000000000, 7.337500000000, 7.350000000000, 7.362500000000, 7.375000000000, 7.387500000000, 7.400000000000, 7.412500000000, 7.425000000000, 7.437500000000, 7.450000000000, 7.462500000000, 7.475000000000,
                      7.487500000000, 7.500000000000, 7.512500000000, 7.525000000000, 7.537500000000, 7.550000000000, 7.562500000000, 7.575000000000, 7.587500000000, 7.600000000000, 7.612500000000, 7.625000000000, 7.637500000000, 7.650000000000, 7.662500000000, 7.675000000000, 7.687500000000, 7.700000000000, 7.712500000000, 7.725000000000, 7.737500000000, 7.750000000000, 7.762500000000, 7.775000000000, 7.787500000000, 7.800000000000, 7.812500000000, 7.825000000000, 7.837500000000, 7.850000000000, 7.862500000000, 7.875000000000, 7.887500000000, 7.900000000000, 7.912500000000, 7.925000000000, 7.937500000000, 7.950000000000, 7.962500000000, 7.975000000000, 7.987500000000, 8.000000000000, 8.012500000000, 8.025000000000, 8.037500000000, 8.050000000000, 8.062500000000, 8.075000000000, 8.087500000000, 8.100000000000,
                      8.112500000000, 8.125000000000, 8.137500000000, 8.150000000000, 8.162500000000, 8.175000000000, 8.187500000000, 8.200000000000, 8.212500000000, 8.225000000000, 8.237500000000, 8.250000000000, 8.262500000000, 8.275000000000, 8.287500000000, 8.300000000000, 8.312500000000, 8.325000000000, 8.337500000000, 8.350000000000, 8.362500000000, 8.375000000000, 8.387500000000, 8.400000000000, 8.412500000000, 8.425000000000, 8.437500000000, 8.450000000000, 8.462500000000, 8.475000000000, 8.487500000000, 8.500000000000, 8.512500000000, 8.525000000000, 8.537500000000, 8.550000000000, 8.562500000000, 8.575000000000, 8.587500000000, 8.600000000000, 8.612500000000, 8.625000000000, 8.637500000000, 8.650000000000, 8.662500000000, 8.675000000000, 8.687500000000, 8.700000000000, 8.712500000000, 8.725000000000,
                      8.737500000000, 8.750000000000, 8.762500000000, 8.775000000000, 8.787500000000, 8.800000000000, 8.812500000000, 8.825000000000, 8.837500000000, 8.850000000000, 8.862500000000, 8.875000000000, 8.887500000000, 8.900000000000, 8.912500000000, 8.925000000000, 8.937500000000, 8.950000000000, 8.962500000000, 8.975000000000, 8.987500000000, 9.000000000000, 9.012500000000, 9.025000000000, 9.037500000000, 9.050000000000, 9.062500000000, 9.075000000000, 9.087500000000, 9.100000000000, 9.112500000000, 9.125000000000, 9.137500000000, 9.150000000000, 9.162500000000, 9.175000000000, 9.187500000000, 9.200000000000, 9.212500000000, 9.225000000000, 9.237500000000, 9.250000000000, 9.262500000000, 9.275000000000, 9.287500000000, 9.300000000000, 9.312500000000, 9.325000000000, 9.337500000000, 9.350000000000,
                      9.362500000000, 9.375000000000, 9.387500000000, 9.400000000000, 9.412500000000, 9.425000000000, 9.437500000000, 9.450000000000, 9.462500000000, 9.475000000000, 9.487500000000, 9.500000000000, 9.512500000000, 9.525000000000, 9.537500000000, 9.550000000000, 9.562500000000, 9.575000000000, 9.587500000000, 9.600000000000, 9.612500000000, 9.625000000000, 9.637500000000, 9.650000000000, 9.662500000000, 9.675000000000, 9.687500000000, 9.700000000000, 9.712500000000, 9.725000000000, 9.737500000000, 9.750000000000, 9.762500000000, 9.775000000000, 9.787500000000, 9.800000000000, 9.812500000000, 9.825000000000, 9.837500000000, 9.850000000000, 9.862500000000, 9.875000000000, 9.887500000000, 9.900000000000, 9.912500000000, 9.925000000000, 9.937500000000, 9.950000000000, 9.962500000000, 9.975000000000,
                      9.987500000000, 10.000000000000
                     };
  static float Y[] = {0.000000000000, 0.111803398875, 0.158113883008, 0.193649167310, 0.223606797750, 0.250000000000, 0.273861278753, 0.295803989155, 0.316227766017, 0.335410196625, 0.353553390593, 0.370809924355, 0.387298334621, 0.403112887415, 0.418330013267, 0.433012701892, 0.447213595500, 0.460977222865, 0.474341649025, 0.487339717240, 0.500000000000, 0.512347538298, 0.524404424085, 0.536190264738, 0.547722557505, 0.559016994375, 0.570087712550, 0.580947501931, 0.591607978310, 0.602079728940, 0.612372435696, 0.622494979899, 0.632455532034, 0.642261628933, 0.651920240520, 0.661437827766, 0.670820393250, 0.680073525437, 0.689202437605, 0.698212002188, 0.707106781187, 0.715891053164, 0.724568837309, 0.733143914931, 0.741619848710, 0.750000000000, 0.758287544405, 0.766485485838, 0.774596669241,
                      0.782623792125, 0.790569415042, 0.798435971134, 0.806225774830, 0.813941029805, 0.821583836258, 0.829156197589, 0.836660026534, 0.844097150807, 0.851469318296, 0.858778201866, 0.866025403784, 0.873212459829, 0.880340843083, 0.887411967465, 0.894427191000, 0.901387818866, 0.908295106229, 0.915150260886, 0.921954445729, 0.928708781050, 0.935414346693, 0.942072184071, 0.948683298051, 0.955248658727, 0.961769203084, 0.968245836552, 0.974679434481, 0.981070843517, 0.987420882907, 0.993730345718, 1.000000000000, 1.006230589875, 1.012422836566, 1.018577439373, 1.024695076596, 1.030776406404, 1.036822067666, 1.042832680731, 1.048808848170, 1.054751155486, 1.060660171780, 1.066536450385, 1.072380529476, 1.078192932642, 1.083974169434, 1.089724735885, 1.095445115010, 1.101135777277, 1.106797181059,
                      1.112429773064, 1.118033988750, 1.123610252712, 1.129158979064, 1.134680571791, 1.140175425099, 1.145643923739, 1.151086443322, 1.156503350622, 1.161895003862, 1.167261752993, 1.172603939956, 1.177921898939, 1.183215956620, 1.188486432400, 1.193733638631, 1.198957880828, 1.204159457879, 1.209338662245, 1.214495780149, 1.219631091765, 1.224744871392, 1.229837387625, 1.234908903523, 1.239959676764, 1.244989959799, 1.250000000000, 1.254990039801, 1.259960316835, 1.264911064067, 1.269842509920, 1.274754878398, 1.279648389207, 1.284523257867, 1.289379695823, 1.294217910554, 1.299038105677, 1.303840481041, 1.308625232830, 1.313392553656, 1.318142632646, 1.322875655532, 1.327591804735, 1.332291259447, 1.336974195712, 1.341640786500, 1.346291201784, 1.350925608611, 1.355544171173, 1.360147050874,
                      1.364734406396, 1.369306393763, 1.373863166403, 1.378404875209, 1.382931668594, 1.387443692551, 1.391941090708, 1.396424004377, 1.400892572612, 1.405346932256, 1.409787217987, 1.414213562373, 1.418626095911, 1.423024947076, 1.427410242362, 1.431782106328, 1.436140661635, 1.440486029089, 1.444818327680, 1.449137674619, 1.453444185375, 1.457737973711, 1.462019151721, 1.466287829862, 1.470544116985, 1.474788120375, 1.479019945775, 1.483239697419, 1.487447478064, 1.491643389018, 1.495827530165, 1.500000000000, 1.504160895649, 1.508310312900, 1.512448346225, 1.516575088810, 1.520690632575, 1.524795068198, 1.528888485142, 1.532970971676, 1.537042614894, 1.541103500742, 1.545153714036, 1.549193338483, 1.553222456701, 1.557241150240, 1.561249499600, 1.565247584250, 1.569235482648, 1.573213272255,
                      1.577181029559, 1.581138830084, 1.585086748415, 1.589024858207, 1.592953232207, 1.596871942267, 1.600781059358, 1.604680653588, 1.608570794215, 1.612451549660, 1.616322987524, 1.620185174602, 1.624038176891, 1.627882059610, 1.631716887208, 1.635542723380, 1.639359631076, 1.643167672515, 1.646966909200, 1.650757401922, 1.654539210777, 1.658312395178, 1.662077013859, 1.665833124896, 1.669580785706, 1.673320053068, 1.677050983125, 1.680773631397, 1.684488052792, 1.688194301613, 1.691892431569, 1.695582495781, 1.699264546797, 1.702938636593, 1.706604816588, 1.710263137649, 1.713913650100, 1.717556403732, 1.721191447806, 1.724818831066, 1.728438601744, 1.732050807569, 1.735655495771, 1.739252713093, 1.742842505793, 1.746424919657, 1.750000000000, 1.753567791675, 1.757128339081, 1.760681686166,
                      1.764227876438, 1.767766952966, 1.771298958392, 1.774823934930, 1.778341924378, 1.781852968121, 1.785357107136, 1.788854382000, 1.792344832893, 1.795828499607, 1.799305421545, 1.802775637732, 1.806239186819, 1.809696107085, 1.813146436447, 1.816590212458, 1.820027472320, 1.823458252881, 1.826882590645, 1.830300521772, 1.833712082089, 1.837117307087, 1.840516231931, 1.843908891459, 1.847295320191, 1.850675552332, 1.854049621774, 1.857417562101, 1.860779406593, 1.864135188231, 1.867484939698, 1.870828693387, 1.874166481399, 1.877498335552, 1.880824287380, 1.884144368142, 1.887458608818, 1.890767040119, 1.894069692488, 1.897366596101, 1.900657780875, 1.903943276466, 1.907223112276, 1.910497317454, 1.913765920900, 1.917028951268, 1.920286436967, 1.923538406167, 1.926784886800, 1.930025906562,
                      1.933261492918, 1.936491673104, 1.939716474127, 1.942935922773, 1.946150045603, 1.949358868962, 1.952562418977, 1.955760721561, 1.958953802416, 1.962141687035, 1.965324400703, 1.968501968503, 1.971674415313, 1.974841765813, 1.978004044485, 1.981161275616, 1.984313483298, 1.987460691435, 1.990602923739, 1.993740203738, 1.996872554772, 2.000000000000, 2.003122562401, 2.006240264774, 2.009353129741, 2.012461179750, 2.015564437075, 2.018662923819, 2.021756661916, 2.024845673132, 2.027929979067, 2.031009601159, 2.034084560681, 2.037154878746, 2.040220576310, 2.043281674170, 2.046338192968, 2.049390153192, 2.052437575177, 2.055480479109, 2.058518885024, 2.061552812809, 2.064582282206, 2.067607312814, 2.070627924085, 2.073644135333, 2.076655965730, 2.079663434309, 2.082666559966, 2.085665361461,
                      2.088659857421, 2.091650066335, 2.094636006565, 2.097617696340, 2.100595153760, 2.103568396796, 2.106537443294, 2.109502310973, 2.112463017428, 2.115419580131, 2.118372016431, 2.121320343560, 2.124264578625, 2.127204738618, 2.130140840414, 2.133072900770, 2.136000936329, 2.138924963621, 2.141844999060, 2.144761058953, 2.147673159491, 2.150581316761, 2.153485546736, 2.156385865285, 2.159282288169, 2.162174831044, 2.165063509461, 2.167948338868, 2.170829334609, 2.173706511928, 2.176579885968, 2.179449471770, 2.182315284280, 2.185177338341, 2.188035648704, 2.190890230021, 2.193741096848, 2.196588263649, 2.199431744792, 2.202271554555, 2.205107707120, 2.207940216582, 2.210769096943, 2.213594362118, 2.216416025930, 2.219234102117, 2.222048604329, 2.224859546129, 2.227666940995, 2.230470802320,
                      2.233271143413, 2.236067977500, 2.238861317724, 2.241651177146, 2.244437568746, 2.247220505424, 2.250000000000, 2.252776065214, 2.255548713728, 2.258317958127, 2.261083810919, 2.263846284534, 2.266605391329, 2.269361143582, 2.272113553500, 2.274862633215, 2.277608394786, 2.280350850198, 2.283090011366, 2.285825890132, 2.288558498269, 2.291287847478, 2.294013949391, 2.296736815571, 2.299456457513, 2.302172886644, 2.304886114323, 2.307596151843, 2.310303010430, 2.313006701244, 2.315707235382, 2.318404623874, 2.321098877687, 2.323790007724, 2.326478024826, 2.329162939770, 2.331844763272, 2.334523505986, 2.337199178504, 2.339871791360, 2.342541355024, 2.345207879912, 2.347871376375, 2.350531854709, 2.353189325150, 2.355843797878, 2.358495283014, 2.361143790624, 2.363789330715, 2.366431913240,
                      2.369071548096, 2.371708245126, 2.374342014117, 2.376972864801, 2.379600806858, 2.382225849914, 2.384848003542, 2.387467277263, 2.390083680543, 2.392697222801, 2.395307913401, 2.397915761656, 2.400520776832, 2.403122968140, 2.405722344744, 2.408318915758, 2.410912690248, 2.413503677229, 2.416091885670, 2.418677324490, 2.421260002561, 2.423839928708, 2.426417111710, 2.428991560298, 2.431563283158, 2.434132288928, 2.436698586202, 2.439262183530, 2.441823089415, 2.444381312316, 2.446936860648, 2.449489742783, 2.452039967048, 2.454587541727, 2.457132475061, 2.459674775250, 2.462214450449, 2.464751508773, 2.467285958295, 2.469817807046, 2.472347063015, 2.474873734153, 2.477397828367, 2.479919353527, 2.482438317461, 2.484954727958, 2.487468592767, 2.489979919598, 2.492488716123, 2.494994989975,
                      2.497498748748, 2.500000000000, 2.502498751248, 2.504995009975, 2.507488783624, 2.509980079602, 2.512468905280, 2.514955267992, 2.517439175035, 2.519920633671, 2.522399651126, 2.524876234591, 2.527350391220, 2.529822128135, 2.532291452420, 2.534758371127, 2.537222891273, 2.539685019840, 2.542144763777, 2.544602130000, 2.547057125390, 2.549509756796, 2.551960031035, 2.554407954889, 2.556853535109, 2.559296778414, 2.561737691490, 2.564176280992, 2.566612553542, 2.569046515733, 2.571478174125, 2.573907535247, 2.576334605598, 2.578759391646, 2.581181899828, 2.583602136553, 2.586020108197, 2.588435821109, 2.590849281606, 2.593260495978, 2.595669470483, 2.598076211353, 2.600480724789, 2.602883016964, 2.605283094023, 2.607680962081, 2.610076627228, 2.612470095523, 2.614861372999, 2.617250465660,
                      2.619637379486, 2.622022120425, 2.624404694402, 2.626785107313, 2.629163365027, 2.631539473388, 2.633913438213, 2.636285265293, 2.638654960392, 2.641022529249, 2.643387977577, 2.645751311065, 2.648112535373, 2.650471656140, 2.652828678976, 2.655183609470, 2.657536453184, 2.659887215654, 2.662235902395, 2.664582518895, 2.666927070619, 2.669269563008, 2.671610001479, 2.673948391424, 2.676284738215, 2.678619047196, 2.680951323691, 2.683281573000, 2.685609800399, 2.687936011143, 2.690260210463, 2.692582403567, 2.694902595642, 2.697220791852, 2.699536997339, 2.701851217221, 2.704163456598, 2.706473720545, 2.708782014116, 2.711088342345, 2.713392710243, 2.715695122800, 2.717995584985, 2.720294101747, 2.722590678012, 2.724885318688, 2.727178028659, 2.729468812791, 2.731757675930, 2.734044622898,
                      2.736329658502, 2.738612787526, 2.740894014733, 2.743173344869, 2.745450782658, 2.747726332807, 2.750000000000, 2.752271788905, 2.754541704168, 2.756809750418, 2.759075932264, 2.761340254297, 2.763602721087, 2.765863337188, 2.768122107133, 2.770379035439, 2.772634126602, 2.774887385102, 2.777138815400, 2.779388421937, 2.781636209140, 2.783882181415, 2.786126343151, 2.788368698720, 2.790609252475, 2.792848008754, 2.795084971875, 2.797320146140, 2.799553535834, 2.801785145224, 2.804014978562, 2.806243040080, 2.808469333997, 2.810693864511, 2.812916635807, 2.815137652052, 2.817356917396, 2.819574435974, 2.821790211904, 2.824004249289, 2.826216552213, 2.828427124746, 2.830635970944, 2.832843094843, 2.835048500467, 2.837252191822, 2.839454172900, 2.841654447677, 2.843853020112, 2.846049894152,
                      2.848245073725, 2.850438562748, 2.852630365119, 2.854820484724, 2.857008925432, 2.859195691099, 2.861380785565, 2.863564212655, 2.865745976181, 2.867926079940, 2.870104527713, 2.872281323269, 2.874456470361, 2.876629972729, 2.878801834097, 2.880972058178, 2.883140648668, 2.885307609251, 2.887472943596, 2.889636655360, 2.891798748184, 2.893959225698, 2.896118091515, 2.898275349238, 2.900431002455, 2.902585054740, 2.904737509656, 2.906888370750, 2.909037641558, 2.911185325602, 2.913331426391, 2.915475947423, 2.917618892179, 2.919760264131, 2.921900066737, 2.924038303443, 2.926174977680, 2.928310092869, 2.930443652419, 2.932575659723, 2.934706118166, 2.936835031118, 2.938962401937, 2.941088233971, 2.943212530552, 2.945335295005, 2.947456530638, 2.949576240751, 2.951694428629, 2.953811097548,
                      2.955926250771, 2.958039891550, 2.960152023123, 2.962262648720, 2.964371771556, 2.966479394838, 2.968585521759, 2.970690155503, 2.972793299239, 2.974894956129, 2.976995129321, 2.979093821953, 2.981191037153, 2.983286778035, 2.985381047706, 2.987473849258, 2.989565185775, 2.991655060330, 2.993743475985, 2.995830435789, 2.997915942784, 3.000000000000, 3.002082610456, 3.004163777160, 3.006243503111, 3.008321791298, 3.010398644698, 3.012474066278, 3.014548058997, 3.016620625800, 3.018691769625, 3.020761493399, 3.022829800038, 3.024896692451, 3.026962173533, 3.029026246172, 3.031088913246, 3.033150177621, 3.035210042155, 3.037268509697, 3.039325583086, 3.041381265149, 3.043435558707, 3.045488466568, 3.047539991534, 3.049590136395, 3.051638903933, 3.053686296920, 3.055732318120, 3.057776970284,
                      3.059820256159, 3.061862178479, 3.063902739971, 3.065941943351, 3.067979791328, 3.070016286602, 3.072051431861, 3.074085229788, 3.076117683054, 3.078148794324, 3.080178566252, 3.082207001484, 3.084234102658, 3.086259872402, 3.088284313336, 3.090307428072, 3.092329219213, 3.094349689353, 3.096368841078, 3.098386676966, 3.100403199585, 3.102418411498, 3.104432315255, 3.106444913402, 3.108456208474, 3.110466202999, 3.112474899497, 3.114482300479, 3.116488408449, 3.118493225903, 3.120496755326, 3.122498999199, 3.124499959994, 3.126499640173, 3.128498042192, 3.130495168500, 3.132491021535, 3.134485603731, 3.136478917512, 3.138470965295, 3.140461749488, 3.142451272494, 3.144439536706, 3.146426544510, 3.148412298286, 3.150396800405, 3.152380053230, 3.154362059118, 3.156342820417, 3.158322339471,
                      3.160300618612, 3.162277660168
                     };
  static int nGrid = 801;
  static float hCstScale = 3200.000000000000;
  static float hCstGrid = 40.000000000000;

  return QuadInterp(x, X, Y, nGrid, hCstScale, hCstGrid);
}


/* Simple implementation of abs() */
float Abs(float x){
  if (x<0.0){
    return -x;
  } else {
    return x;
  }
}

/* Simple implementation of fmod() */
float Fmod(float x, float den) {
  float base = (float)( (int)(x / den) );
  return x - base * den;
}


/* Clamps the input to be between min and max */
float Clamp(float x, float min, float max){
  if (x < min) return min;
  if (x > max) return max;
  return x;
}


/* Square Wave, with equal time spend at min and max. */
float SquareWave(float time, float period, float min, float max) {
  float phase = Fmod(time, period) / period;
  if (phase < 0.5) {
    return min;
  } else {
    return max;
  }
}


/* Sine Wave, with user-defined period, min, and max values */
float SineWave(float time, float period, float min, float max) {
  float arg = TWO_PI * time / period;
  return 0.5 * (min + max) + 0.5 * (max - min) * Sin(arg);
}


/* Triangle Wave, with user-defined period, min, and max values */
float TriangleWave(float time, float period, float min, float max) {
  float slope = (max - min) / period;
  float phase;
  time = Fmod(time, period);
  phase = time / period;
  if (phase < 0.5) { // Rising side
    return 2.0 * phase * slope * period + min;
  } else { // falling side
    return -2.0 * (phase - 0.5) * slope * period + max;
  }
}

/* SawTooth Wave, with user-defined period, min, and max values */
float SawToothWave(float time, float period, float min, float max) {
  float slope = (max - min) / period;
  time = Fmod(time, period);
  return slope * time + min;
}
